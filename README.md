# Академическое исследование: CFA → PLS-SEM (медиация и модерация)

Этот репозиторий — **архив одного конкретного академического исследования**.  
Он не является шаблоном или универсальным пайплайном, а фиксирует **реальный ход работы**, включая данные, код, промежуточные проверки и итоговые результаты.

Репозиторий устроен так, чтобы можно было:
- быстро понять логику исследования,
- посмотреть итоговые результаты в отчетах и Excel,
- при необходимости — **проследить, как именно эти результаты были получены в коде**.

---

## Общая логика исследования

Исследование выстроено последовательно и отражает фактический аналитический процесс:

1. Проверка измерительной модели с помощью CFA.
2. Построение структурной модели PLS-SEM с медиацией.
3. Оценка моделей:
   - на общей выборке,
   - по ритейлерам.
4. Проверка устойчивости медиационных эффектов:
   - по кластерам,
   - по полу.
5. Проверка однородности выборки и обоснование квотирования.

Код и результаты на каждом этапе равноправны: **без кода не было бы результатов, без результатов код не имел бы смысла**.

---

## Как ориентироваться в репозитории

### 1. Итоговые PLS-SEM модели

**Папка:** `Показатели/`

Здесь находятся ключевые Excel-файлы с результатами двухстадийной PLS-SEM:

- `all_pls_2stage_direct_indirect_r2.xlsx` — модель на общем датасете  
- `lenta_pls_2stage_direct_indirect_r2.xlsx` — модель для «Ленты»
- `magnit_pls_2stage_direct_indirect_r2.xlsx` — модель для «Магнита»
- `pyaterka_pls_2stage_direct_indirect_r2.xlsx` — модель для «Пятёрочки`

Каждый файл содержит:
- коэффициенты детерминации (R²),
- прямые эффекты,
- косвенные эффекты,
- p-value и bootstrap-доверительные интервалы.

Текстовая фиксация этих результатов приведена в файле:
- `Общий_SEM.md`

---

### 2. Факторный анализ (измерительная модель)

**Папка:** `Факторный анализ/`

Этот раздел показывает, **как формировалась измерительная модель**, и содержит как код, так и результаты.

- `Код CFA/`
  - `cfa_initial.R` — первичная CFA
  - `cfa_main.R` — уточненная CFA
  - `cfa_two_staged.R` — CFA для двухстадийной (HCM) модели
- `Рез-ты CFA/`
  - `initial_cfa.xlsx`
  - `cfa_hcm_loadings_reliability.xlsx`
  - `cfa_second_order_loadings.xlsx`
- `Отчет по CFA.md` — связный текстовый отчет по результатам CFA

Код CFA отражает фактические итерации анализа и напрямую связан с полученными таблицами.

---

### 3. Кластеры и кластерная модерация

**Папка:** `По кластерам/`

Раздел делится на два связанных этапа.

**Кластерный анализ**
- `clusters.R` — расчет кластеров
- `Кластерный анализ.md` — описание и интерпретация кластеров

**PLS-SEM по кластерам**
- `pls_clusters.R` — расчет моделей и разностей эффектов
- `pls_2stage_cluster_indirect_diffs.xlsx` — разности косвенных эффектов между кластерами
- `Кластерная модерация.md` — выводы о наличии или отсутствии кластерной модерации с числовыми доказательствами

---

### 4. Гендерная модерация

**Папка:** `По полу/`

- `pls_gender.R` — расчет PLS-SEM и разностей эффектов по полу
- `pls_2stage_gender_indirect_diffs.xlsx` — Excel-таблица с разностями косвенных эффектов
- `Модерация.md` — текстовый вывод по результатам проверки гендерной модерации

---

### 5. Подготовка данных и квотирование

**Папка:** `Подготовка данных и квотирование/`

Раздел фиксирует работу с выборкой до моделирования.

- `Кодирование столбцов.ipynb` — подготовка и кодирование переменных
- `quoting.ipynb` — квотирование выборки
- `Соцдем сравнения.xlsx` — социально-демографические сравнения
- `Однородность и квоты.md` — обоснование корректности структуры выборки

---

## Про данные и этику

Сырые данные в репозитории отсутствуют.  
Это сделано осознанно из-за NDA и этических ограничений.

В репозитории сохранены:
- код,
- агрегированные результаты,
- отчеты,
- таблицы с итоговыми коэффициентами и проверками.

Этого достаточно, чтобы понять **как именно строились выводы и на каких числах они основаны**.

---

## Как читать репозиторий на практике

Рекомендуемый порядок:
1. `Общий_SEM.md` — общая картина структурной модели.
2. `Отчет по CFA.md` — понимание измерительной модели.
3. `Кластерная модерация.md` и `Модерация.md` — проверки устойчивости эффектов.
4. Соответствующие `.xlsx` — если нужны конкретные числа.
5. `.R` и `.ipynb` — если важно увидеть, как именно получены результаты.

Репозиторий предназначен для прозрачного представления **процесса и результатов одного исследования**, где код и аналитические выводы существуют как равноправные части одной работы.
